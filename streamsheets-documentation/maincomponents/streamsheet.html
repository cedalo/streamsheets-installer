

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Streamsheet &mdash; Streamsheets Documentation 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dashboard" href="dashboard.html" />
    <link rel="prev" title="Stream Machine" href="streammachine.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Streamsheets Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../maincomponents.html">Main Components</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="streammachine.html">Stream Machine</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Streamsheet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#streamsheets">Streamsheet</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inbox">Inbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inbox-settings">Inbox Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#grid">Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="#streamsheets-settings">Streamsheets Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#messages">Messages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dashboard.html">Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="administration.html">Administration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../others.html">Other</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releasenotes.html">Release Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Streamsheets Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../maincomponents.html">Main Components</a> &raquo;</li>
        
      <li>Streamsheet</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/maincomponents/streamsheet.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="streamsheet">
<span id="id1"></span><h1>Streamsheet<a class="headerlink" href="#streamsheet" title="Permalink to this headline">¶</a></h1>
<div class="section" id="streamsheets">
<span id="id2"></span><h2>Streamsheet<a class="headerlink" href="#streamsheets" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><a class="reference internal" href="../_images/Streamsheet1.PNG"><img alt="Streamsheet1" src="../_images/Streamsheet1.PNG" style="width: 793.6px; height: 492.8px;" /></a></div>
</div>
<p>Streamsheets are the main components to create the logic for your use cases. Here you model how a <a class="reference internal" href="../glossary.html#term-stream-machine"><span class="xref std std-term">Stream Machine</span></a> works and, thus, how data streams are processed, analysed, visualized, combined and controlled or even simulated.</p>
<div class="line-block">
<div class="line"><strong>To connect a data stream to a Streamsheet you can:</strong></div>
</div>
<ul class="simple">
<li>Select a <a class="reference internal" href="../glossary.html#term-consumer"><span class="xref std std-term">Consumer</span></a> (This is the most common case; however, a Consumer must be created in the <span class="xref std std-ref">administration</span> first)</li>
<li>Use specific functions, e.g. <a class="reference internal" href="../functions/streamsheet/opcuaread.html#opcuaread"><span class="std std-ref">OPCUA.READ</span></a> or <a class="reference internal" href="../functions/streamsheet/restrequest.html#restrequest"><span class="std std-ref">REST.REQUEST</span></a> with GET-Method</li>
</ul>
<div class="line-block">
<div class="line"><strong>To create an outgoing data stream or make data available you have several options:</strong></div>
</div>
<ul class="simple">
<li>Choose a Producer function, e.g. <a class="reference internal" href="../functions/streamsheet/mqttpublish.html#mqttpublish"><span class="std std-ref">MQTT.PUBLISH</span></a> or <a class="reference internal" href="../functions/streamsheet/kafkapublish.html#kafkapublish"><span class="std std-ref">KAFKA.PUBLISH</span></a></li>
<li>Choose a posting function, e.g. <a class="reference internal" href="../functions/streamsheet/opcuawrite.html#opcuawrite"><span class="std std-ref">OPCUA.WRITE</span></a> or <a class="reference internal" href="../functions/streamsheet/restrequest.html#restrequest"><span class="std std-ref">REST.REQUEST</span></a> with POST-Method</li>
<li>Expose the Stream Machine as <a class="reference internal" href="../glossary.html#term-opc-ua"><span class="xref std std-term">OPC UA</span></a> or <a class="reference internal" href="../glossary.html#term-rest"><span class="xref std std-term">REST</span></a> Server so that other services can access its data</li>
<li>Store the data in a database, e.g. by using <a class="reference internal" href="../functions/streamsheet/mongostore.html#mongostore"><span class="std std-ref">MONGO.STORE</span></a></li>
</ul>
<p>Often, a Streamsheet consumes and produces streams. Nonetheless, neither an incoming nor an outgoing data stream are mandatory. For instance, Streamsheets which are calculated repeatedly and only produce streams are great for simulating sensors, machines, APIs and other data sources. On the other hand, sheets with pure dashboard and visualization functionality typically only consume streams without generating one on their own.</p>
<p>Each Streamsheet consists of an Inbox and a Grid.</p>
</div>
<div class="section" id="inbox">
<span id="inbox-picture"></span><span id="id3"></span><h2>Inbox<a class="headerlink" href="#inbox" title="Permalink to this headline">¶</a></h2>
<p>As in a mail service, the Inbox marks the point where new messages arrive and queue in order of their arrival time before they are processed. Although the Inbox only displays up to a maximum of 100 messages on your client (your browser), an unlimited amount can be queued on the server.
The structure and content of a message is given in full detail and presented as a <a class="reference internal" href="../glossary.html#term-json"><span class="xref std std-term">JSON</span></a> Object in the <a class="reference internal" href="../glossary.html#term-payload"><span class="xref std std-term">Payload</span></a> section. Should the original data format not be JSON, the format is automatically converted. Via drag and drop some or all payload elements of incoming messages can be linked to the grid. Now, every time a new message arrives and the <a class="reference internal" href="../glossary.html#term-streamsheet"><span class="xref std std-term">Streamsheet</span></a> is calculated, the respective cells are updated.
Message streams are connected to a Streamsheet by selecting a Consumer in the Inbox Settings. The name of the selected Consumer is then also shown above the Inbox. Consumers define incoming data streams (More on them under <span class="xref std std-ref">Consumer</span>).</p>
<p><a class="reference internal" href="../_images/Inbox.JPG"><img alt="Inbox" src="../_images/Inbox.JPG" style="width: 272.25px; height: 506.7px;" /></a></p>
<p>The inbox above holds two messages. The first has the Message-IDs HJFG5rEDV and holds one data element as content, a temperature measurement.</p>
</div>
<div class="section" id="inbox-settings">
<span id="id4"></span><h2>Inbox Settings<a class="headerlink" href="#inbox-settings" title="Permalink to this headline">¶</a></h2>
<p>In this settings menu you decide which data streams a Streamsheet consumes and also its recalculation mode.
The settings explained point by point:</p>
<ul>
<li><p class="first">“<a class="reference internal" href="../glossary.html#term-consumer"><span class="xref std std-term">Consumer</span></a>” lists all available Consumers. Choose the one which delivers the desired data streams. To define new or adjust existing Consumers, please go to the Administration Menu.</p>
</li>
<li><p class="first">“Calculate Streamsheet” defines the recalculation mode of a Streamsheet:</p>
<blockquote>
<div><ul class="simple">
<li>“<strong>Continuously</strong>”: The Streamsheet is recalculated continuously and cyclically until the machine is stopped - also if NO messages are received. The sheet´s cycle time is the cycle time of the Stream Machine. (This is the default setting)</li>
<li>“<strong>On Message Arrival</strong>”: Every time a message is received, the sheet is calculated immediately. In this mode message queues are not formed because the sheet is recalculated irrespective of the cycle time of the Stream Machine.</li>
<li>“<strong>On EXECUTE Formula</strong>”: The calculation of a Streamsheet is triggered by another Streamsheet which contains an <a class="reference internal" href="../functions/streamsheet/execute.html#execute"><span class="std std-ref">EXECUTE</span></a> formula. This triggering sheet must be in the same Stream Machine. Note: The sheet triggering the execution will pause its calculation in the cell containing EXECUTE, wait until the triggered sheet has completed its calculation and, then, resume its calculation.</li>
<li>“<strong>On Machine Start</strong>”: The Streamsheet calculates once when the Stream Machine is started.</li>
<li>“<strong>On Machine Stop</strong>”: The Streamsheet calculates when the Machine is being stopped.</li>
<li>“<strong>On Time</strong>”: A date and time for the calculation can be defined. Additionally, a sheet-specific interval can be set to recalculate the sheet cyclically. This interval only applies to this sheet and overwrites the cycle time of its Stream Machine.</li>
<li>“<strong>On Random</strong>”: A date and time for the calculation and additionally an interval for the recalculation can be defined. In this respect it is similar to “On Time”, however, the calculation will not be triggered at the beginning of each interval but randomly during the interval. This mode provides a way for introducing randomness, which can be interesting when simulating data sources, for instance.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Loop through array (one calculation per array element): This comes in handy if your messages contain information through which you want to loop, e.g. a list of ordered products. If this option is checked, an array element within incoming messages can be selected. Then, the Streamsheet loops through all elements which are subsumed under this array element. As a result, not one message per calculation is processed but only one element under the array element. The easiest way to set a loop element is to right-click on it in the inbox-payload and choose this option. Alternatively, you can define it and its superelement by listing the respective keys.</p>
</li>
<li><p class="first">„<strong>Hide unprocessed Messages</strong>”: If this option is checked, a queue of messages is not displayed in the inbox. Only the next message to be processed is displayed.</p>
</li>
</ul>
<p>Quick remarks:
+ A Consumer delivers messages to a Streamsheet.
+ Via drag &amp; drop the content of messages can be linked to the Streamsheet grid.
+ A Producer can be used to send messages from a Streamsheet to a destination.</p>
</div>
<div class="section" id="grid">
<h2>Grid<a class="headerlink" href="#grid" title="Permalink to this headline">¶</a></h2>
<p>The grid of a Streamsheet is the place where the logic for analysing, processing and visualizing data is modelled. This is done by using spreadsheet functions and the tools you find in the tool bar.
Streamsheets offer familiar spreadsheet formulas, as e.g. known from MS Excel or Google Sheets, as well as formulas especially designed for working with data streams and dynamic data structures. All formulas are explained in detail in the <a class="reference internal" href="../functions.html#functions"><span class="std std-ref">Functions</span></a> section.
The recalculation of a Streamsheet can be triggered in various ways, e.g. always when a new message arrives, at specific points in time or cyclically. (Jump to <a class="reference internal" href="#inbox-settings"><span class="std std-ref">Inbox Settings</span></a> to see all calculation modes) However when a Streamsheet is calculated, this always happens cell by cell from left to right and from top to bottom thus maximizing transparency over what is happening in which order.
Special columns</p>
<ul class="simple">
<li><strong>IF-Column:</strong> This is the first column right before “A”. Cells in this column take conditions and based on the state of these conditions, the respective rows are being calculated or not. As a result, IF-cells switch the calculation of entire rows and their cells on and off. The default value of IF-cells is TRUE. Thus, if IF-cells are empty, the rows are calculated.</li>
<li><strong>COMMENT-Column:</strong> Even further to the left of the IF-column is the COMMENT column which is hidden by default. This column is intended for documenting what your model does.</li>
</ul>
<div class="line-block">
<div class="line"><a class="reference internal" href="../_images/GRID.PNG"><img alt="GRID" src="../_images/GRID.PNG" style="width: 776.04px; height: 581.74px;" /></a></div>
</div>
<p>In the left corner above the grid, the name of the Streamsheet is given and how many times it has been calculated since the last Stream Machine stop (Note: Pausing a Stream Machine will not reset the Step Counter). On the right, you can maximize, minimize and delete a sheet or open its settings.</p>
</div>
<div class="section" id="streamsheets-settings">
<h2>Streamsheets Settings<a class="headerlink" href="#streamsheets-settings" title="Permalink to this headline">¶</a></h2>
<p>In this menu you find the settings for the basic structure and appearance of a Streamsheet.</p>
<p><strong>Settings:</strong></p>
<ul class="simple">
<li><strong>Name</strong>: A Streamsheet can be renamed.</li>
<li><strong>Columns</strong>: Set the number of columns (Max: 50)</li>
<li><strong>Rows</strong>: Set the number of rows (Max: 200)</li>
<li><strong>Protect sheet</strong>: No interaction with grid or the Inbox is possible</li>
<li><strong>Show Grid</strong>: Display the grid or do not</li>
<li><strong>Show Headers</strong>: Display column and row titles or do not</li>
<li><strong>Show Formulas</strong>: Decide whether you want to see the formulas or the current values of cells in the sheet.</li>
<li><strong>Show Inbox</strong>: Display the Inbox or do not</li>
<li><strong>Paint IF Rows with transparency</strong>: If this box is checked, the content of rows which contain a statement in the IF-column are transparent. This improves transparency and helps you to immediately identify the rows which are being switch on and off when the machine is running.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Streamsheets are always calculated from left to right and then from top to bottom.</li>
<li>Depending on the condition in the IF column, the calculation of whole rows can be switched on and off.</li>
</ul>
</div>
</div>
<div class="section" id="messages">
<h2>Messages<a class="headerlink" href="#messages" title="Permalink to this headline">¶</a></h2>
<p>In the Streamsheet environment, all messages are <a class="reference internal" href="../glossary.html#term-json"><span class="xref std std-term">JSON</span></a> objects. In case the original data format is not JSON, but e.g. csv, xml or a text file, the format is automatically converted to JSON.</p>
<p><strong>JSON</strong></p>
<ul class="simple">
<li>Json objects are a hierarchy of key-value pairs. This means that any value, e.g. a number or a string, is identified by its key. You could think of the key as the name or the title of its value. In order not to just have a flat list of key-value pairs, these can be ordered and subsumed, e.g. in the <a class="reference internal" href="#inbox-picture"><span class="std std-ref">Inbox</span></a> the key-value pair “Temperature: 34” is subsumed under the top-element “Data”.</li>
</ul>
<p><strong>Connect message content to the Grid</strong></p>
<ul class="simple">
<li>To link data elements of an incoming stream to the grid, simply drag-and-drop the respective elements. You can also link all elements under a top-element at once by drag-and-dropping their top-element. If you hit Strg or Cmd while you are doing this, the drag-and-drop range turns by 90°.</li>
<li>Of course, Streamsheets offer the possibility to use a function to read incoming data. This function is called READ and it is also automatically created when you drag-and-drop elements into the sheet.</li>
</ul>
<p><strong>Generate message content aka a JSON object in the sheet</strong></p>
<p>In order to send data, you need to create a JSON object and then use a producer or posting function.</p>
<ul class="simple">
<li>You can convert any coherent cell range consisting of two columns and an arbitrary number of rows into a JSON object. Simply select the range, then, right-click it and choose “Define JSON Range”. This generates a flat JSON object, that is to say that all keys are in the first column, the respective values are in the second column and the object is not hierarchically structured. To build a hierarchy, select the elements you want to subsume and hit “tab” on your keyboard. If you want to undo this operation, just hit “tab” and “shift” at the same time.</li>
<li>If you turn more than 2 columns into a single JSON range, the first column will contain the keys whereas the remaining columns accommodate the values. Example: A range of 4 columns is turned into a JSON range. The first column contains the keys which all value-columns will share. Each value-column will automatically assume the keys in the first column to build key-value pairs.</li>
<li>To send messages or make JSON ranges available choose one of the ways mentioned under <a class="reference internal" href="#streamsheets"><span class="std std-ref">Streamsheet</span></a></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dashboard.html" class="btn btn-neutral float-right" title="Dashboard" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="streammachine.html" class="btn btn-neutral" title="Stream Machine" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Cedalo AG

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

	
		<script type="text/javascript">
			var DOCUMENTATION_OPTIONS = {
				URL_ROOT:'../',
				VERSION:'1.0.0',
				LANGUAGE:'None',
				COLLAPSE_INDEX:false,
				FILE_SUFFIX:'.html',
				HAS_SOURCE:  true,
				SOURCELINK_SUFFIX: '.txt'
			};
		</script>
			<script type="text/javascript" src="../_static/jquery.js"></script>
			<script type="text/javascript" src="../_static/underscore.js"></script>
			<script type="text/javascript" src="../_static/doctools.js"></script>
	

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>